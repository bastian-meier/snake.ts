{"version":3,"sources":["node_modules/browser-pack/_prelude.js","src/main.ts"],"names":[],"mappings":"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","file":"bundle.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","import {square} from './sqare';\n\nclass snake {\n\n    private ctx:CanvasRenderingContext2D;\n    private width:number;\n    private height:number;\n    private settingsHolder:HTMLElement;\n    private scoreHolder:HTMLElement;\n    private scoreDiv:HTMLElement;\n    private interval:any;\n    private keyPushed = false;\n    private squareWidth = 20;\n    private xBoxes:number;\n    private yBoxes:number;\n    private player:square = {x: 10, y: 10};\n    private apple:square = {x:15, y:15};\n    private velocity:square = {x:1, y:0};\n    private trail:any = [];\n    private tail = 5;\n\n    constructor(canvasId:string, ticksPerSecond:number){\n        const canv = <HTMLCanvasElement>document.getElementById(canvasId);\n        this.scoreDiv = document.getElementById('score');\n        this.settingsHolder = document.getElementById('settingsHolder');\n        this.scoreHolder = document.getElementById('scoreHolder');\n        this.ctx = canv.getContext(\"2d\");\n        this.width = canv.width;\n        this.height = canv.height;\n        this.xBoxes = Math.floor(this.width / this.squareWidth);\n        this.yBoxes = Math.floor(this.height / this.squareWidth);\n        this.settingsHolder.style.display = 'none';\n\n        this.setBackground();\n        this.drawApple();\n        this.interval = setInterval(()=>{\n            this.gameTick()},1000/ticksPerSecond\n        );\n        document.addEventListener('keydown',(e:KeyboardEvent) => {\n            this.keyPush(e);\n        });\n    }\n\n    drawSquare(point:square, color:string){\n        this.ctx.fillStyle = color;\n        this.ctx.fillRect(point.x * this.squareWidth,point.y * this.squareWidth,this.squareWidth-2,this.squareWidth-2);\n    }\n\n    setBackground() {\n        this.ctx.fillStyle = 'black';\n        this.ctx.fillRect(0,0, this.xBoxes * this.squareWidth, this.yBoxes * this.squareWidth);\n    }\n\n    drawApple() {\n        this.drawSquare(this.apple, 'green');\n    }\n\n    setNewPoint() {\n        this.player.x += this.velocity.x;\n        this.player.y += this.velocity.y;\n        if(this.player.x < 0) {\n            this.player.x = this.xBoxes-1;\n        }\n        if(this.player.x > this.xBoxes-1) {\n            this.player.x = 0;\n        }\n        if(this.player.y < 0) {\n            this.player.y = this.yBoxes-1;\n        }\n        if(this.player.y > this.yBoxes-1) {\n            this.player.y = 0;\n        }\n        this.keyPushed = false;\n    }\n\n    renewSnake() {\n        for (let point of this.trail) {\n            this.drawSquare(point, 'yellow');\n            if(this.checkIfSamePosition(point, this.player)) {\n                this.finishGame(point);\n            }\n        }\n        this.trail.push({x:this.player.x, y:this.player.y});\n        while(this.trail.length > this.tail) {\n            let point = this.trail.shift();\n            this.drawSquare(point, 'black');\n        }\n    }\n\n    checkIfSamePosition(firstPoint:square, secondPoint: square) {\n        return firstPoint.x === secondPoint.x && firstPoint.y === secondPoint.y;\n    }\n\n    checkForApple() {\n        if(this.checkIfSamePosition(this.apple, this.player)) {\n            this.tail++;\n            while(true){\n                this.apple = {\n                    x: Math.floor(Math.random() * this.xBoxes),\n                    y: Math.floor(Math.random() * this.yBoxes)\n                };\n                if(!this.appleIsInsideSnake()) {\n                    break;\n                }\n            }\n            this.drawApple();\n            this.setScore();\n        }\n    }\n\n    appleIsInsideSnake() {\n        for (let point of this.trail) {\n            if(this.checkIfSamePosition(this.apple, point)){\n                return true;\n            }\n        }\n        return false;\n    }\n\n    finishGame(point:square) {\n        setTimeout(()=>{\n            this.drawSquare(point, 'red');\n            clearInterval(this.interval);\n            this.settingsHolder.style.display = 'block';\n        }, 10)\n    }\n\n    setScore() {\n        let score = this.tail - 5;\n        this.scoreHolder.style.display = 'block';\n        this.scoreDiv.innerText = '' + score;\n    }\n\n    gameTick() {\n        this.setNewPoint();\n        this.renewSnake();\n        this.checkForApple();\n    }\n\n    keyPush(evt:KeyboardEvent) {\n        if(!this.keyPushed){\n            this.keyPushed = true;\n            switch(evt.keyCode) {\n                case 37:\n                    if(this.velocity.x !== 1 && this.velocity.y !== 0){\n                        this.velocity = {x:-1, y:0};\n                    }\n                    break;\n                case 38:\n                    if(this.velocity.x !== 0 && this.velocity.y !== 1){\n                        this.velocity = {x:0, y:-1};\n                    }\n                    break;\n                case 39:\n                    if(this.velocity.x !== -1 && this.velocity.y !== 0){\n                        this.velocity = {x:1, y:0};\n                    }\n                    break;\n                case 40:\n                    if(this.velocity.x !== 0 && this.velocity.y !== -1){\n                        this.velocity = {x:0, y:1};\n                    }\n                    break;\n            }\n        }\n    }\n}\n\nlet button = document.getElementById('start');\nbutton.onclick = () => {\n    let input = <HTMLInputElement>document.getElementById('ticks');\n    new snake('snake', +input.value);\n};\n"],"preExistingComment":"//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJzcmMvbWFpbi50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTs7Ozs7OztzRENFQTs7O0FBbUJJLG1CQUFZLEFBQWUsVUFBRSxBQUFxQjs7Ozs7QUFWMUMsYUFBUyxZQUFHLEFBQUssQUFBQztBQUNsQixhQUFXLGNBQUcsQUFBRSxBQUFDO0FBR2pCLGFBQU0sU0FBVSxFQUFDLEFBQUMsR0FBRSxBQUFFLElBQUUsQUFBQyxHQUFFLEFBQUUsQUFBQyxBQUFDO0FBQy9CLGFBQUssUUFBVSxFQUFDLEFBQUMsR0FBQyxBQUFFLElBQUUsQUFBQyxHQUFDLEFBQUUsQUFBQyxBQUFDO0FBQzVCLGFBQVEsV0FBVSxFQUFDLEFBQUMsR0FBQyxBQUFDLEdBQUUsQUFBQyxHQUFDLEFBQUMsQUFBQyxBQUFDO0FBQzdCLGFBQUssUUFBTyxBQUFFLEFBQUM7QUFDZixhQUFJLE9BQUcsQUFBQyxBQUFDO0FBR2IsWUFBTSxBQUFJLE9BQXNCLEFBQVEsU0FBQyxBQUFjLGVBQUMsQUFBUSxBQUFDLEFBQUM7QUFDbEUsQUFBSSxhQUFDLEFBQVEsV0FBRyxBQUFRLFNBQUMsQUFBYyxlQUFDLEFBQU8sQUFBQyxBQUFDO0FBQ2pELEFBQUksYUFBQyxBQUFjLGlCQUFHLEFBQVEsU0FBQyxBQUFjLGVBQUMsQUFBZ0IsQUFBQyxBQUFDO0FBQ2hFLEFBQUksYUFBQyxBQUFXLGNBQUcsQUFBUSxTQUFDLEFBQWMsZUFBQyxBQUFhLEFBQUMsQUFBQztBQUMxRCxBQUFJLGFBQUMsQUFBRyxNQUFHLEFBQUksS0FBQyxBQUFVLFdBQUMsQUFBSSxBQUFDLEFBQUM7QUFDakMsQUFBSSxhQUFDLEFBQUssUUFBRyxBQUFJLEtBQUMsQUFBSyxBQUFDO0FBQ3hCLEFBQUksYUFBQyxBQUFNLFNBQUcsQUFBSSxLQUFDLEFBQU0sQUFBQztBQUMxQixBQUFJLGFBQUMsQUFBTSxTQUFHLEFBQUksS0FBQyxBQUFLLE1BQUMsQUFBSSxL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LEdBQUMsQ0FBQyxBQUFDLEFBQUMsQUFBQyxBQUNoQztBQUFDO0FBQ0QsQUFBSyxBQUFDO0FBQ1YseUJBQUssQUFBRTtBQUNILEFBQUUsNEJBQUMsQUFBSSxLQUFDLEFBQVEsU0FBQyxBQUFDLE1BQUssQ0FBQyxBQUFDLEtBQUksQUFBSSxLQUFDLEFBQVEsU0FBQyxBQUFDLE1BQUssQUFBQyxBQUFDLEdBQUEsQUFBQztBQUNoRCxBQUFJLGlDQUFDLEFBQVEsV0FBRyxFQUFDLEFBQUMsR0FBQyxBQUFDLEdBQUUsQUFBQyxHQUFDLEFBQUMsQUFBQyxBQUFDLEFBQy9CO0FBQUM7QUFDRCxBQUFLLEFBQUM7QUFDVix5QkFBSyxBQUFFO0FBQ0gsQUFBRSw0QkFBQyxBQUFJLEtBQUMsQUFBUSxTQUFDLEFBQUMsTUFBSyxBQUFDLEtBQUksQUFBSSxLQUFDLEFBQVEsU0FBQyxBQUFDLE1BQUssQ0FBQyxBQUFDLEFBQUMsR0FBQSxBQUFDO0FBQ2hELEFBQUksaUNBQUMsQUFBUSxXQUFHLEVBQUMsQUFBQyxHQUFDLEFBQUMsR0FBRSxBQUFDLEdBQUMsQUFBQyxBQUFDLEFBQUMsQUFDL0I7QUFBQztBQUNELEFBQUssQUFBQyxBQUNkLEFBQUMsQUFDTDs7QUFBQyxBQUNMO0FBQUMsQUFDSjs7Ozs7O0FBRUQsSUFBSSxBQUFNLFNBQUcsQUFBUSxTQUFDLEFBQWMsZUFBQyxBQUFPLEFBQUMsQUFBQztBQUM5QyxBQUFNLE9BQUMsQUFBTyxVQUFHO0FBQ2IsUUFBSSxBQUFLLFFBQXFCLEFBQVEsU0FBQyxBQUFjLGVBQUMsQUFBTyxBQUFDLEFBQUM7QUFDL0QsUUFBSSxBQUFLLE1BQUMsQUFBTyxTQUFFLENBQUMsQUFBSyxNQUFDLEFBQUssQUFBQyxBQUFDLEFBQ3JDO0FBQUMsQUFBQyIsImZpbGUiOiJnZW5lcmF0ZWQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uIGUodCxuLHIpe2Z1bmN0aW9uIHMobyx1KXtpZighbltvXSl7aWYoIXRbb10pe3ZhciBhPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7aWYoIXUmJmEpcmV0dXJuIGEobywhMCk7aWYoaSlyZXR1cm4gaShvLCEwKTt2YXIgZj1uZXcgRXJyb3IoXCJDYW5ub3QgZmluZCBtb2R1bGUgJ1wiK28rXCInXCIpO3Rocm93IGYuY29kZT1cIk1PRFVMRV9OT1RfRk9VTkRcIixmfXZhciBsPW5bb109e2V4cG9ydHM6e319O3Rbb11bMF0uY2FsbChsLmV4cG9ydHMsZnVuY3Rpb24oZSl7dmFyIG49dFtvXVsxXVtlXTtyZXR1cm4gcyhuP246ZSl9LGwsbC5leHBvcnRzLGUsdCxuLHIpfXJldHVybiBuW29dLmV4cG9ydHN9dmFyIGk9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtmb3IodmFyIG89MDtvPHIubGVuZ3RoO28rKylzKHJbb10pO3JldHVybiBzfSkiLCJpbXBvcnQge3NxdWFyZX0gZnJvbSAnLi9zcWFyZSc7XG5cbmNsYXNzIHNuYWtlIHtcblxuICAgIHByaXZhdGUgY3R4OkNhbnZhc1JlbmRlcmluZ0NvbnRleHQyRDtcbiAgICBwcml2YXRlIHdpZHRoOm51bWJlcjtcbiAgICBwcml2YXRlIGhlaWdodDpudW1iZXI7XG4gICAgcHJpdmF0ZSBzZXR0aW5nc0hvbGRlcjpIVE1MRWxlbWVudDtcbiAgICBwcml2YXRlIHNjb3JlSG9sZGVyOkhUTUxFbGVtZW50O1xuICAgIHByaXZhdGUgc2NvcmVEaXY6SFRNTEVsZW1lbnQ7XG4gICAgcHJpdmF0ZSBpbnRlcnZhbDphbnk7XG4gICAgcHJpdmF0ZSBrZXlQdXNoZWQgPSBmYWxzZTtcbiAgICBwcml2YXRlIHNxdWFyZVdpZHRoID0gMjA7XG4gICAgcHJpdmF0ZSB4Qm94ZXM6bnVtYmVyO1xuICAgIHByaXZhdGUgeUJveGVzOm51bWJlcjtcbiAgICBwcml2YXRlIHBsYXllcjpzcXVhcmUgPSB7eDogMTAsIHk6IDEwfTtcbiAgICBwcml2YXRlIGFwcGxlOnNxdWFyZSA9IHt4OjE1LCB5OjE1fTtcbiAgICBwcml2YXRlIHZlbG9jaXR5OnNxdWFyZSA9IHt4OjEsIHk6MH07XG4gICAgcHJpdmF0ZSB0cmFpbDphbnkgPSBbXTtcbiAgICBwcml2YXRlIHRhaWwgPSA1O1xuXG4gICAgY29uc3RydWN0b3IoY2FudmFzSWQ6c3RyaW5nLCB0aWNrc1BlclNlY29uZDpudW1iZXIpe1xuICAgICAgICBjb25zdCBjYW52ID0gPEhUTUxDYW52YXNFbGVtZW50PmRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGNhbnZhc0lkKTtcbiAgICAgICAgdGhpcy5zY29yZURpdiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzY29yZScpO1xuICAgICAgICB0aGlzLnNldHRpbmdzSG9sZGVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NldHRpbmdzSG9sZGVyJyk7XG4gICAgICAgIHRoaXMuc2NvcmVIb2xkZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2NvcmVIb2xkZXInKTtcbiAgICAgICAgdGhpcy5jdHggPSBjYW52LmdldENvbnRleHQoXCIyZFwiKTtcbiAgICAgICAgdGhpcy53aWR0aCA9IGNhbnYud2lkdGg7XG4gICAgICAgIHRoaXMuaGVpZ2h0ID0gY2Fudi5oZWlnaHQ7XG4gICAgICAgIHRoaXMueEJveGVzID0gTWF0aC5mbG9vcih0aGlzLndpZHRoIC8gdGhpcy5zcXVhcmVXaWR0aCk7XG4gICAgICAgIHRoaXMueUJveGVzID0gTWF0aC5mbG9vcih0aGlzLmhlaWdodCAvIHRoaXMuc3F1YXJlV2lkdGgpO1xuICAgICAgICB0aGlzLnNldHRpbmdzSG9sZGVyLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG5cbiAgICAgICAgdGhpcy5zZXRCYWNrZ3JvdW5kKCk7XG4gICAgICAgIHRoaXMuZHJhd0FwcGxlKCk7XG4gICAgICAgIHRoaXMuaW50ZXJ2YWwgPSBzZXRJbnRlcnZhbCgoKT0+e1xuICAgICAgICAgICAgdGhpcy5nYW1lVGljaygpfSwxMDAwL3RpY2tzUGVyU2Vjb25kXG4gICAgICAgICk7XG4gICAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLChlOktleWJvYXJkRXZlbnQpID0+IHtcbiAgICAgICAgICAgIHRoaXMua2V5UHVzaChlKTtcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgZHJhd1NxdWFyZShwb2ludDpzcXVhcmUsIGNvbG9yOnN0cmluZyl7XG4gICAgICAgIHRoaXMuY3R4LmZpbGxTdHlsZSA9IGNvbG9yO1xuICAgICAgICB0aGlzLmN0eC5maWxsUmVjdChwb2ludC54ICogdGhpcy5zcXVhcmVXaWR0aCxwb2ludC55ICogdGhpcy5zcXVhcmVXaWR0aCx0aGlzLnNxdWFyZVdpZHRoLTIsdGhpcy5zcXVhcmVXaWR0aC0yKTtcbiAgICB9XG5cbiAgICBzZXRCYWNrZ3JvdW5kKCkge1xuICAgICAgICB0aGlzLmN0eC5maWxsU3R5bGUgPSAnYmxhY2snO1xuICAgICAgICB0aGlzLmN0eC5maWxsUmVjdCgwLDAsIHRoaXMueEJveGVzICogdGhpcy5zcXVhcmVXaWR0aCwgdGhpcy55Qm94ZXMgKiB0aGlzLnNxdWFyZVdpZHRoKTtcbiAgICB9XG5cbiAgICBkcmF3QXBwbGUoKSB7XG4gICAgICAgIHRoaXMuZHJhd1NxdWFyZSh0aGlzLmFwcGxlLCAnZ3JlZW4nKTtcbiAgICB9XG5cbiAgICBzZXROZXdQb2ludCgpIHtcbiAgICAgICAgdGhpcy5wbGF5ZXIueCArPSB0aGlzLnZlbG9jaXR5Lng7XG4gICAgICAgIHRoaXMucGxheWVyLnkgKz0gdGhpcy52ZWxvY2l0eS55O1xuICAgICAgICBpZih0aGlzLnBsYXllci54IDwgMCkge1xuICAgICAgICAgICAgdGhpcy5wbGF5ZXIueCA9IHRoaXMueEJveGVzLTE7XG4gICAgICAgIH1cbiAgICAgICAgaWYodGhpcy5wbGF5ZXIueCA+IHRoaXMueEJveGVzLTEpIHtcbiAgICAgICAgICAgIHRoaXMucGxheWVyLnggPSAwO1xuICAgICAgICB9XG4gICAgICAgIGlmKHRoaXMucGxheWVyLnkgPCAwKSB7XG4gICAgICAgICAgICB0aGlzLnBsYXllci55ID0gdGhpcy55Qm94ZXMtMTtcbiAgICAgICAgfVxuICAgICAgICBpZih0aGlzLnBsYXllci55ID4gdGhpcy55Qm94ZXMtMSkge1xuICAgICAgICAgICAgdGhpcy5wbGF5ZXIueSA9IDA7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5rZXlQdXNoZWQgPSBmYWxzZTtcbiAgICB9XG5cbiAgICByZW5ld1NuYWtlKCkge1xuICAgICAgICBmb3IgKGxldCBwb2ludCBvZiB0aGlzLnRyYWlsKSB7XG4gICAgICAgICAgICB0aGlzLmRyYXdTcXVhcmUocG9pbnQsICd5ZWxsb3cnKTtcbiAgICAgICAgICAgIGlmKHRoaXMuY2hlY2tJZlNhbWVQb3NpdGlvbihwb2ludCwgdGhpcy5wbGF5ZXIpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5maW5pc2hHYW1lKHBvaW50KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB0aGlzLnRyYWlsLnB1c2goe3g6dGhpcy5wbGF5ZXIueCwgeTp0aGlzLnBsYXllci55fSk7XG4gICAgICAgIHdoaWxlKHRoaXMudHJhaWwubGVuZ3RoID4gdGhpcy50YWlsKSB7XG4gICAgICAgICAgICBsZXQgcG9pbnQgPSB0aGlzLnRyYWlsLnNoaWZ0KCk7XG4gICAgICAgICAgICB0aGlzLmRyYXdTcXVhcmUocG9pbnQsICdibGFjaycpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgY2hlY2tJZlNhbWVQb3NpdGlvbihmaXJzdFBvaW50OnNxdWFyZSwgc2Vjb25kUG9pbnQ6IHNxdWFyZSkge1xuICAgICAgICByZXR1cm4gZmlyc3RQb2ludC54ID09PSBzZWNvbmRQb2ludC54ICYmIGZpcnN0UG9pbnQueSA9PT0gc2Vjb25kUG9pbnQueTtcbiAgICB9XG5cbiAgICBjaGVja0ZvckFwcGxlKCkge1xuICAgICAgICBpZih0aGlzLmNoZWNrSWZTYW1lUG9zaXRpb24odGhpcy5hcHBsZSwgdGhpcy5wbGF5ZXIpKSB7XG4gICAgICAgICAgICB0aGlzLnRhaWwrKztcbiAgICAgICAgICAgIHdoaWxlKHRydWUpe1xuICAgICAgICAgICAgICAgIHRoaXMuYXBwbGUgPSB7XG4gICAgICAgICAgICAgICAgICAgIHg6IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIHRoaXMueEJveGVzKSxcbiAgICAgICAgICAgICAgICAgICAgeTogTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogdGhpcy55Qm94ZXMpXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICBpZighdGhpcy5hcHBsZUlzSW5zaWRlU25ha2UoKSkge1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLmRyYXdBcHBsZSgpO1xuICAgICAgICAgICAgdGhpcy5zZXRTY29yZSgpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgYXBwbGVJc0luc2lkZVNuYWtlKCkge1xuICAgICAgICBmb3IgKGxldCBwb2ludCBvZiB0aGlzLnRyYWlsKSB7XG4gICAgICAgICAgICBpZih0aGlzLmNoZWNrSWZTYW1lUG9zaXRpb24odGhpcy5hcHBsZSwgcG9pbnQpKXtcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgZmluaXNoR2FtZShwb2ludDpzcXVhcmUpIHtcbiAgICAgICAgc2V0VGltZW91dCgoKT0+e1xuICAgICAgICAgICAgdGhpcy5kcmF3U3F1YXJlKHBvaW50LCAncmVkJyk7XG4gICAgICAgICAgICBjbGVhckludGVydmFsKHRoaXMuaW50ZXJ2YWwpO1xuICAgICAgICAgICAgdGhpcy5zZXR0aW5nc0hvbGRlci5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJztcbiAgICAgICAgfSwgMTApXG4gICAgfVxuXG4gICAgc2V0U2NvcmUoKSB7XG4gICAgICAgIGxldCBzY29yZSA9IHRoaXMudGFpbCAtIDU7XG4gICAgICAgIHRoaXMuc2NvcmVIb2xkZXIuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7XG4gICAgICAgIHRoaXMuc2NvcmVEaXYuaW5uZXJUZXh0ID0gJycgKyBzY29yZTtcbiAgICB9XG5cbiAgICBnYW1lVGljaygpIHtcbiAgICAgICAgdGhpcy5zZXROZXdQb2ludCgpO1xuICAgICAgICB0aGlzLnJlbmV3U25ha2UoKTtcbiAgICAgICAgdGhpcy5jaGVja0ZvckFwcGxlKCk7XG4gICAgfVxuXG4gICAga2V5UHVzaChldnQ6S2V5Ym9hcmRFdmVudCkge1xuICAgICAgICBpZighdGhpcy5rZXlQdXNoZWQpe1xuICAgICAgICAgICAgdGhpcy5rZXlQdXNoZWQgPSB0cnVlO1xuICAgICAgICAgICAgc3dpdGNoKGV2dC5rZXlDb2RlKSB7XG4gICAgICAgICAgICAgICAgY2FzZSAzNzpcbiAgICAgICAgICAgICAgICAgICAgaWYodGhpcy52ZWxvY2l0eS54ICE9PSAxICYmIHRoaXMudmVsb2NpdHkueSAhPT0gMCl7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnZlbG9jaXR5ID0ge3g6LTEsIHk6MH07XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAzODpcbiAgICAgICAgICAgICAgICAgICAgaWYodGhpcy52ZWxvY2l0eS54ICE9PSAwICYmIHRoaXMudmVsb2NpdHkueSAhPT0gMSl7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnZlbG9jaXR5ID0ge3g6MCwgeTotMX07XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAzOTpcbiAgICAgICAgICAgICAgICAgICAgaWYodGhpcy52ZWxvY2l0eS54ICE9PSAtMSAmJiB0aGlzLnZlbG9jaXR5LnkgIT09IDApe1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy52ZWxvY2l0eSA9IHt4OjEsIHk6MH07XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSA0MDpcbiAgICAgICAgICAgICAgICAgICAgaWYodGhpcy52ZWxvY2l0eS54ICE9PSAwICYmIHRoaXMudmVsb2NpdHkueSAhPT0gLTEpe1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy52ZWxvY2l0eSA9IHt4OjAsIHk6MX07XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG59XG5cbmxldCBidXR0b24gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc3RhcnQnKTtcbmJ1dHRvbi5vbmNsaWNrID0gKCkgPT4ge1xuICAgIGxldCBpbnB1dCA9IDxIVE1MSW5wdXRFbGVtZW50PmRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0aWNrcycpO1xuICAgIG5ldyBzbmFrZSgnc25ha2UnLCAraW5wdXQudmFsdWUpO1xufTtcbiJdfQ=="}